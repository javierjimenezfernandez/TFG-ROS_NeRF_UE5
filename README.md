(üá™üá∏) [Versi√≥n en espa√±ol](https://github.com/javierjimenezfernandez/TFG-ROS_NeRF_UE5/tree/main?tab=readme-ov-file#gemelo-digital-control-telem%C3%A1tico-y-rv-generada-por-nerf-y-3dgs-en-tareas-de-rescatehttps://github.com/javierjimenezfernandez/TFG-ROS_NeRF_UE5/tree/main?tab=readme-ov-file#gemelo-digital-control-telem%C3%A1tico-y-rv-generada-por-nerf-y-3dgs-en-tareas-de-rescate)

# DIGITAL TWIN, TELEMATIC CONTROL AND VR GENERATED BY NERF AND 3DGS IN RESCUE TASKS
<div align="justify">
In the digital era, Digital Twins have emerged as key tools for real-time simulation and control of complex physical environments. This final degree project (TFG) presents an immersive telematic control system that combines digital twins with virtual reality (VR) in Unreal Engine, employing advanced technologies such as Neural Radiance Fields (NeRF) and 3D Gaussian Splatting (3DGS). The research demonstrates the feasibility of integrating these 3D reconstruction methods into rescue operations, providing immersive and detailed visualization of the affected environment, facilitating faster response and reducing risk to rescue teams. The main contributions include the identification of optimal tools for the generation of 3D models compatible with digital twin simulation, the evaluation of robustness and deployment times in realistic scenarios, and the compatibility with the lines of research in simulation and telematic control of the Robotics and Cybernetics Laboratory (ROBCIB) of the CAR ETSII UPM-CSIC. The combination of the tools allows an effective deployment in about an hour and a half, demonstrating its applicability in simulated rescue situations.
</div>

&nbsp;
&nbsp;

<div align="center">

<img height="200" alt="(a) Thermal camera. Robustness testing of 3DGS. Images inside the Unreal Engine simulation" src="https://github.com/user-attachments/assets/5bf5a4e0-953b-40ab-a999-4aea5d00673a" >
<img height="200" alt="(a) Under the sea. Robustness testing of 3DGS. Images inside the Unreal Engine simulation" src="https://github.com/user-attachments/assets/109712de-76bb-47a6-86c7-bd6243763262" >
<img height="200" alt="(a) Smoke. Robustness testing of 3DGS. Images inside the Unreal Engine simulation" src="https://github.com/user-attachments/assets/f2a9ae73-9c2a-4e56-a747-35a7b3511757" >
<img height="200" alt="(a) Flowers (complex geometry). Robustness testing of 3DGS. Images inside the Unreal Engine simulation" src="https://github.com/user-attachments/assets/36176a2e-84b2-448c-9952-6ba89b2c71c7" >

> Robustness testing of 3DGS[^2]. From left to right and from top to bottom: thermal camera, under the sea, smoke, flowers (complex geometry). Images inside the Unreal Engine simulation. _Source: own elaboration_

&nbsp;
&nbsp;

![Deployment of technology in a simulated rescue situation](https://github.com/user-attachments/assets/1a185adc-16fa-4f26-bab2-833bc96975ab)

> Deployment of technology in a simulated rescue situation. _Source: own elaboration_

</div>

&nbsp;
&nbsp;

## About this repository
<div align="justify">
In this repository you can find:
- The source code of the nodes and the launcher with the ROS parameters necessary for the communication between the robot and Unreal Engine.
- The complete Unreal Engine 5.2. project used for the development of the investigatin including the plugins with the modifications indicated in the memory.
- The manuals of installation and use of the tools used.
- The compilation of basic ROS concepts and commands necessary for the project.
</div>

## Information available
<div align="justify">
The following YouTube channel is available where they can be found the first tests performed with instant-ngp, the robustness tests of the 3D model generation capability for environments considered difficult and the video demonstration of the deployment of the technology.

YouTube channel: [https://www.youtube.com/@JavierJimenezFernandez-upm](https://www.youtube.com/@JavierJimenezFernandez-upm)

The list of videos on the YouTube channel is as follows:
- instant-ngp - Yellow Flowers Training
- 3DGS Robustness Testing - Environments with Repetitive Elements
- 3DGS Robustness Testing - Small Object Sizes
- 3DGS Robustness Testing - Elements with Complex Geometry
- 3DGS Robustness Testing - Smoky or Foggy Scenes
- 3DGS Robustness Testing - Night Scenes
- 3DGS Robustness Testing - Thermal Camera Recordings
- 3DGS Robustness Testing - Reflected and Refracted Scenes
- Demonstration of the complete workflow

</div>

&nbsp;
&nbsp;
&nbsp;
&nbsp;

# GEMELO DIGITAL, CONTROL TELEM√ÅTICO Y RV GENERADA POR NERF Y 3DGS EN TAREAS DE RESCATE
<div align="justify">
En la era digital, los gemelos digitales (Digital Twins) han surgido como herramientas clave para la simulaci√≥n y el control en tiempo real de entornos f√≠sicos complejos. Este trabajo de fin de grado (TFG) presenta un sistema de control telem√°tico inmersivo que combina gemelos digitales con realidad virtual (RV) en Unreal Engine, empleando tecnolog√≠as avanzadas como Neural Radiance Fields (NeRF) y 3D Gaussian Splatting (3DGS). La investigaci√≥n demuestra la viabilidad de integrar estos m√©todos de reconstrucci√≥n 3D en operaciones de rescate, proporcionando una visualizaci√≥n inmersiva y detallada del entorno afectado, lo que facilita una respuesta m√°s r√°pida y reduce el riesgo para los equipos de rescate. Las contribuciones principales incluyen la identificaci√≥n de herramientas √≥ptimas para la generaci√≥n de modelos 3D compatibles con la simulaci√≥n de gemelos digitales, la evaluaci√≥n de la robustez y tiempos de despliegue en escenarios realistas, y la compatibilidad con las l√≠neas de investigaci√≥n en simulaci√≥n y control telem√°tico del laboratorio de Rob√≥tica y Cibern√©tica (ROBCIB) del CAR ETSII UPM-CSIC. La combinaci√≥n de las herramientas permite un despliegue efectivo en aproximadamente una hora y media, demostrando su aplicabilidad en situaciones simuladas de rescate.
</div>

&nbsp;
&nbsp;

<div align="center">

<img height="200" alt="(a) C√°mara t√©rmica. Ensayos de robustez de 3DGS. Im√°genes dentro de la simulaci√≥n de Unreal Engine" src="https://github.com/user-attachments/assets/5bf5a4e0-953b-40ab-a999-4aea5d00673a" >
<img height="200" alt="(a) Bajo el mar. Ensayos de robustez de 3DGS. Im√°genes dentro de la simulaci√≥n de Unreal Engine" src="https://github.com/user-attachments/assets/109712de-76bb-47a6-86c7-bd6243763262" >
<img height="200" alt="(a) Humo. Ensayos de robustez de 3DGS. Im√°genes dentro de la simulaci√≥n de Unreal Engine" src="https://github.com/user-attachments/assets/f2a9ae73-9c2a-4e56-a747-35a7b3511757" >
<img height="200" alt="(a) Flores (geometr√≠a compleja). Ensayos de robustez de 3DGS. Im√°genes dentro de la simulaci√≥n de Unreal Engine" src="https://github.com/user-attachments/assets/36176a2e-84b2-448c-9952-6ba89b2c71c7" >

> Ensayos de robustez de 3DGS[^2]. De izquierda a derecha y de arriba a abajo: c√°mara t√©rmica, bajo el mar, humo, flores (geometr√≠a compleja). Im√°genes dentro de la simulaci√≥n de Unreal Engine. _Fuente: elaboraci√≥n propia_

&nbsp;
&nbsp;

![Despliegue de la tecnolog√≠a en una situaci√≥n de rescate simulada](https://github.com/user-attachments/assets/1a185adc-16fa-4f26-bab2-833bc96975ab)

> Despliegue de la tecnolog√≠a en una situaci√≥n de rescate simulada. _Fuente: elaboraci√≥n propia_

</div>

&nbsp;
&nbsp;

## Acerca de este repositorio
<div align="justify">
En este repositorio podr√°n encontrar:
- El c√≥digo fuente de los nodos y el launcher con los par√°metros de ROS necesarios para la comunicaci√≥n entre el robot y Unreal Engine.
- El proyecto completo de Unreal Engine 5.2. utilizado para el desarrollo del trabajo incluyendo los plugins con las modificaciones indicadas en la memoria.
- Los manuales de instalaci√≥n y uso de las herramientas utilizadas.
- La recopilaci√≥n de conceptos y comandos de ROS b√°sicos necesarios para el proyecto.
</div>

## Informaci√≥n accesible
<div align="justify">
Se pone a disposici√≥n el siguiente canal de YouTube donde se pueden encontrar las primeras pruebas llevadas a cabo con instant-ngp, los ensayos de robustez de la capacidad de generaci√≥n de modelos 3D para entornos considerados dif√≠ciles y el v√≠deo demostrativo del despliegue de la tecnolog√≠a.

Canal de YouTube: [https://www.youtube.com/@JavierJimenezFernandez-upm](https://www.youtube.com/@JavierJimenezFernandez-upm)

La relaci√≥n de v√≠deos que se encuentran en el canal de YouTube es la siguiente:
- instant-ngp - Entrenamiento Flores Amarillas
- Ensayos de robustez de 3DGS - Entornos con elementos repetitivos
- Ensayos de robustez de 3DGS - Objetos de tama√±o reducido
- Ensayos de robustez de 3DGS - Elementos con geometr√≠as complejas
- Ensayos de robustez de 3DGS - Escenas con humo o niebla
- Ensayos de robustez de 3DGS - Escenas nocturnas
- Ensayos de robustez de 3DGS - Grabaciones con c√°mara t√©rmica
- Ensayos de robustez de 3DGS - Escenas con reflejos y refracci√≥n
- Demostraci√≥n del flujo de trabajo completo
</div>

## Descripci√≥n general
<div align="justify">
En la era digital, los gemelos digitales (Digital Twins) han emergido como herramientas fundamentales para la simulaci√≥n y el control en tiempo real de entornos f√≠ƒ±sicos complejos. Este trabajo presenta el desarrollo de un sistema de control telem√°tico inmersivo que combina la tecnolog√≠a de los gemelos digitales con realidad virtual (VR), generada a partir de Neural Radiance Fields (NeRF) y posteriores desarrollos derivados de este como 3D Gaussian Splatting (3DGS).

Para ilustrar el punto de partida se presentan en la figura 0.1 un escenario t√≠pico de entrenamiento de Digital Twins (0.1a) y el estado del arte en teleoperaci√≥n de sistemas rob√≥tico con interfaces de realidad virtual en el laboratorio de Rob√≥tica y Cibern√©tica (ROBCIB) del CAR ETSII - UPM (0.1b); y en la figura 0.2 ejemplos de modelos 3D de entornos f√≠sicos complejos en los que se propone desplegar dichos gemelos digitales.

&nbsp;
&nbsp;

</div>
<div align="center">

<img height="150" alt="Ejemplo (a) de Digital Twins en entornos artificiales o poco realistas" src="https://github.com/user-attachments/assets/751acb4a-73df-4233-9bd6-b63de7f39f2c" >
<img height="150" alt="Ejemplo (b) de Digital Twins en entornos artificiales o poco realistas" src="https://github.com/user-attachments/assets/f53dd621-1235-438d-bf9e-e698f8c36276" >

> Figuras 0.1a y 0.1b. Ejemplos de Digital Twins en entornos artificiales o poco realistas. _Fuentes:_ [^3] y [^4].

&nbsp;
&nbsp;

<img height="300" alt="Ejemplos de modelos 3D de entornos complejos generados con 3DGS" src="https://github.com/user-attachments/assets/8b7f329f-a1af-4639-8341-a7336d56de95" >

> Figura 0.2: Ejemplos de modelos 3D de entornos complejos generados con 3DGS. _Fuente:_ [^2]

&nbsp;
&nbsp;

</div>
<div align="justify">

Esta investigaci√≥n busca demostrar que es posible la integraci√≥n de estas tecnolog√≠as de reconstrucci√≥n de modelos 3D con las operaciones de rescate en situaciones de emergencia, proporcionando a los operadores una visualizaci√≥n inmersiva y detallada del entorno afectado.

La reconstrucci√≥n precisa y realista de entornos tridimensionales a partir de im√°genes bidimensionales en la que puedan operar los gemelos digitales de los robots desplegados tambi√©n permite la simulaci√≥n de posibles escenarios de cat√°strofe.

De esta forma no solo se facilita una respuesta m√°s r√°pida y efectiva, sino que tambi√©n reduce el riesgo para los equipos de rescate.

Las principales aportaciones de este proyecto son las siguientes:
1. La combinaci√≥n de herramientas √≥ptima para la obtenci√≥n de un modelo 3D compatible con la simulaci√≥n de los gemelos digitales de los robots.
2. La robustez y el tiempo de despliegue de la tecnolog√≠a en situaciones de aplicaci√≥n realistas.
3. La compatibilidad con las l√≠neas de investigaci√≥n actuales del laboratorio de Rob√≥tica y Cibern√©tica (ROBCIB) del CAR ETSII UPM-CSIC en particular la simulaci√≥n y el control telem√°tico de robots mediante el uso de la realidad virtual para una colaboraci√≥n m√°s estrecha y segura entre operadores y robots.

La combinaci√≥n de las herramientas utilizadas en este proyecto permite el despliegue de la tecnolog√≠a en un tiempo aproximado de una hora y media para una situaci√≥n simulada de rescate.

Tras descartar instant-ngp[^5] y Unity por incompatibilidades, se han escogido las herramientas recopiladas en la lista mostrada a continuaci√≥n. En la figura 0.3 se muestra el diagrama del flujo de trabajo completo de dichas herramientas y, despu√©s, la tabla 0.1 recoje los tiempos empleados para su despliegue.

-	FFmpeg[^6], para el preprocesamiento, y COLMAP[^7] con la adici√≥nn de hloc[^8], para la obtenci√≥n de la fotogrametr√≠a.
-	Splatfacto[^9] (m√©todo del entorno de NerfStudio[^9] para 3DGS[^2]) y volinga-model[^10], para la generaci√≥n del modelo 3D de la escena.
-	Volinga Suite[^10], para compatibilidad con Unreal Engine (UE).
-	UE junto con el plugin de Volinga[^10], para su representaci√≥n en un entorno de realidad virtual compatible con la simulaci√≥n de los gemelos digitales de los robots.
-	Rosbridge[^11] y ROSIntegration[^12], para la compatibilidad con las l√≠neas actuales de investigaci√≥n que usan el est√°ndar de ROS.

</div>
<div align="center">

&nbsp;
&nbsp;

<img alt="Flujo de trabajo completo" src="https://github.com/user-attachments/assets/7f7ed627-fc66-483e-a8ea-2afcc8328fd5" >

> Figura 0.3: Flujo de trabajo completo. _Fuente: elaboraci√≥n propia_

&nbsp;
&nbsp;

<img height="300" alt="Tabla de tiempos de despliegue del flujo de trabajo completo" src="https://github.com/user-attachments/assets/b4998254-9a7f-4310-8a9f-b1108d60f0b7" >

> Tabla 0.1: Tabla de tiempos de despliegue del flujo de trabajo completo. _Fuente: elaboraci√≥n propia_

</div>
<div align="justify">

&nbsp;
&nbsp;

Con todo ello, el aspecto de la tecnolog√≠a desplegada durante la demostraci√≥n se puede observar en las im√°genes de la figura 0.4.

</div>
<div align="center">

&nbsp;
&nbsp;

<img alt="Demostraci√≥n del flujo de trabajo completo" src="https://github.com/user-attachments/assets/4ff0cf6a-3136-4187-ab96-527165159d97" >

> Figura 0.4: Demostraci√≥n del flujo de trabajo completo. _Fuente: elaboraci√≥n propia_

&nbsp;
&nbsp;

</div>

## Palabras clave
<div align="justify">
Digital Twin, control telem√°tico, simulaci√≥n inmersiva, NeRF, Gaussian Splatting, Unreal Engine, realidad virtual para rescates.
</div>

## Referencias
[^1]: Mildenhall, B. et al. (2020). _NeRF: Representing Scenes as Neural Radiance Fields for View Synthesis_. En: _ECCV 2020 Oral_. url: [https://www.matthewtancik.com/nerf](https://www.matthewtancik.com/nerf)
[^2]: Kerbl, B., Kopanas, G., Leimk¬®uhler, T. y Drettakis, G. (jul. de 2023). _3D Gaussian Splatting for Real-Time Radiance Field Rendering_. En: _ACM Transactions on Graphics 42.4_. url: [https://repo-sam.inria.fr/fungraph/3d-gaussian-splatting/](https://repo-sam.inria.fr/fungraph/3d-gaussian-splatting/).
[^3]: Rudin, N., Hoeller, D., Reist, P. y Hutter, M. (2021). _Learning to Walk in Minutes Using Massively Parallel Deep Reinforcement Learning_. En: _ArXiv abs/2109.11978_. url: [https://api.semanticscholar.org/CorpusID:237635100](https://api.semanticscholar.org/CorpusID:237635100).
[^4]: Cruz Ulloa, C. (mar. de 2024). _Quadrupedal Robots in Search and Rescue: Perception and Teleoperation_. doi: 10.20868/UPM.thesis.81769. url: [https://oa.upm.es/81769/](https://oa.upm.es/81769/).
[^5]: M√ºller, T., Evans, A., Schied, C. y Keller, A. (jul. de 2022). _Instant Neural Graphics Primitives with a Multiresolution Hash Encoding_. En: _ACM Trans. Graph. 41.4_, 102:1-102:15. doi: 10.1145/3528223.3530127. url: [https://doi.org/10.1145/3528223.3530127](https://doi.org/10.1145/3528223.3530127) y [https://nvlabs.github.io/instant-ngp/](https://nvlabs.github.io/instant-ngp/).
[^6]: Tomar, S. (2006). _Converting video formats with FFmpeg_. En: _Linux Journal 2006.146, p√°g. 10_. url: [https://www.ffmpeg.org/](https://www.ffmpeg.org/)
[^7]: Sch√∂nberger, J. L., Zheng, E., Pollefeys, M. y Frahm, J.-M. (2016). _Pixelwise View Selection for Unstructured Multi-View Stereo_. En: _European Conference on Computer Vision (ECCV)_. url: [https://colmap.github.io/](https://colmap.github.io/)
[^8]: Sarlin, P.-E., Cadena, C., Siegwart, R. y Dymczyk, M. (2019). _From Coarse to Fine: Robust Hierarchical Localization at Large Scale_. En: _CVPR_. url: [https://github.com/cvg/Hierarchical-Localization](https://github.com/cvg/Hierarchical-Localization)
[^9]: Tancik, M. et al. (2023). _Nerfstudio: A Modular Framework for Neural Radiance Field Development_. En: _ACM SIGGRAPH 2023 Conference Proceedings. SIGGRAPH ‚Äô23_. url: [https://docs.nerf.studio/](https://docs.nerf.studio/)
[^10]: Volinga development team (2023). _Volinga Suite, volinga-model and Volinga plugin_. url: [https://volinga.ai/](https://volinga.ai/) y [https://github.com/Volinga/volinga-model](https://github.com/Volinga/volinga-model)
[^11]: Crick, C., Jay, G., Osentoski, S., Pitzer, B. y Jenkins, O. C. (2011). _ROSbridge: ROS for Non-ROS Users_. En: _Proceedings of the Robotics Systems Science and Systems Conference (RSS)_. url: [http://rosbridge.org](http://rosbridge.org).
[^12]: Schmeisser, M. y Suero, M. (2018). _ROSIntegration: Connecting Unreal Engine with ROS for Realistic Simulations_. En: _Proceedings of the IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS)_. url: [https://github.com/code-iai/ROSIntegration](https://github.com/code-iai/ROSIntegration).
